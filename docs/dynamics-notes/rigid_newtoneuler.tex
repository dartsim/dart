\section{Rigid Body Dynamics: Newton-Euler equations}
This section describes the familiar Newton-Euler equations of rigid
body dynamics. We begin with the momenta of the rigid body whose mass,
position of the center of mass (COM), orientation, linear velocity of
the COM, and angular velocity are $m$, $\vc{x}$, $R$, $\vc{v}$, and
$\bm{\omega}$ respectively (these definitions are the same as are found
in Witkin and Baraff's course notes). The linear momentum \vc{P} is computed as:
\begin{eqnarray}
\vc{P} &=& \sum_i \vc{P}_i = \sum_i \sInfMass \dot{\vGlobalPoint}_i = \sum_i  \sInfMass (\vc{v} + \bm{\omega}
    \times \vc{r}_i') \nonumber \\
 &=& m \vc{v}
\end{eqnarray}
where $\vc{r}_i' = \vc{r}_i - \vc{x}$. Because $\sum_i \sInfMass
\vc{r}_i' = \vc{0}$ (property of the COM), the second term vanishes. The angular momentum \vc{L} about the COM is computed as:
\begin{eqnarray}
\nonumber
\vc{L} & = & \sum_i \vc{L}_i  = \sum_i \vc{r}_i' \times \vc{P}_i\\
\nonumber
& = & \sum_i \sInfMass \vc{r}_i' \times (\vc{v} + \bm{\omega} \times \vc{r}_i')\\
&= & \vc{0} + \sum_i \sInfMass [\vc{r}_i'][\bm{\omega}]\vc{r}_i' = \left ( \sum_i -\sInfMass [\vc{r}_i'][\vc{r}_i'] \right )\bm{\omega}
\end{eqnarray}
The notation $[\vc{a}] \vc{b}$ denotes the cross product $\vc{a}\times \vc{b}$ with $[\vc{a}]$ being the skew-symmetric matrix corresponding to the vector $\vc{a}$:
\begin{equation}
[\vc{a}] = 
\begin{pmatrix}
0 & -a_3 & a_2\\
a_3&  0 & -a_1\\
-a_2 & a_1 & 0
\end{pmatrix}
\end{equation}
Therefore the following identities hold: $[\vc{a}]\vc{b} = -[\vc{b}]\vc{a}$ and $[\vc{a}]^T = -[\vc{a}]$.

Now recall the inertia tensor about the COM defined in Witkin and
Baraff's course notes: $I_c = \sum_i \sInfMass ((\vc{r}_i'^T
\vc{r}_i')\vc{I}_3 - \vc{r}_i' \vc{r}_i'^T)$, where $\vc{I}_3$ is the $3\times 3$
identity matrix. We can easily show that
$I_c = \sum_i -\sInfMass [\vc{r}_i'][\vc{r}_i']$ by verifying the
identity $-[\vc{a}][\vc{a}] = (\vc{a}^T\vc{a}) \vc{I}_3  -
\vc{a}\vc{a}^T$. As a result, we write the angular momentum of a rigid body as:
\begin{equation}
\vc{L} = I_c \bm{\omega}
\end{equation}
where the inertia tensor can be written as $I_c = RI_0R^T$. $R$ is the rotation matrix corresponding to the orientation of the body and $I_0$ is the constant inertia tensor defined at zero rotation. From Witkin and Baraff's course notes, we also learned that the angular velocity in the skew-symmetric form is related to the rotation matrix $R$ as $[\bm{\omega}] = \dot{R}R^T$.

With these definitions, we can derive the equations of motion for a
rigid body. The equations corresponding to the linear force can be evaluated as:
\begin{eqnarray}
\label{eq:force}
\vc{f} & = & \dot{\vc{p}} = m \dot{\vc{v}}
\end{eqnarray}
The equations corresponding to the torque can be evaluated as:
\begin{eqnarray}
\label{eq:torque}
\nonumber
\bm{\tau} & = & \dot{\vc{L}} = \dot{(I_c \bm{\omega})} \\
\nonumber
& = & I_c\dot{\bm{\omega}} + \dot{(RI_0 R^T)}\bm{\omega} = I_c\dot{\bm{\omega}} + \dot{R}I_0 R^T\bm{\omega} + R I_0 \dot{R}^T\bm{\omega}\\
\nonumber
& = & I_c\dot{\bm{\omega}} + \dot{R}R^T I_c \bm{\omega} + I_c
(\dot{R}R^T)^T\bm{\omega} \\ \nonumber
& = & I_c\dot{\bm{\omega}} + [\bm{\omega}]I_c \bm{\omega} -
I_c[\bm{\omega}]\bm{\omega}  \mbox{\ \ (Using the identity $[\bm{\omega}]^T = -[\bm{\omega}]$)}\\ 
&= & I_c\dot{\bm{\omega}} + \bm{\omega} \times I_c \bm{\omega}
\end{eqnarray}

Combining \eqnref{force} and \eqnref{torque}, we arrive at the
Newton-Euler equations:
\begin{equation}
\label{eq:newtoneuler}
\left(
\begin{array}{cc}
m\vc{I}_3 & \vc{0} \\
\vc{0} & I_c 
\end{array}
\right)
\left(
\begin{array}{c}
\dot{\vc{v}} \\
\dot{\bm{\omega}} 
\end{array}
\right) +
\left(
\begin{array}{c}
\vc{0}  \\
\bm{\omega} \times I_c \bm{\omega} 
\end{array}
\right) = 
\left(
\begin{array}{c}
\vc{f} \\
\bm{\tau} 
\end{array}
\right)
\end{equation}

